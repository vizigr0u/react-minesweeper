(this.webpackJsonpminesweeper=this.webpackJsonpminesweeper||[]).push([[0],{12:function(e,t,s){"use strict";s.r(t);var i=s(5),n=s.n(i),a=s(11),r=s(3),h=s(6),u=s(7),l=s(9),c=s(8),o=s(1),m=s.n(o),f=s(10),v=s.n(f),d=(s(18),s(0)),g=n.a.mark(S),b={Easy:{mines:10,width:9,height:9},Medium:{mines:40,width:16,height:16},Expert:{mines:99,width:30,height:16}},p="\ud83d\ude42",y="\ud83d\udc80",j="\ud83d\ude0e";function k(e){var t="square",s=e.value,i=Number.isInteger(s)&&s>0&&s<=9;return i&&(t+=" square_number_"+s),(i||""===s||"\ud83d\udca5"===s)&&(t+=" square_revealed"),"\ud83d\udea9\ud83d\udca3"===s&&(s="\ud83d\udea9",t+=" square_bad_flag"),Object(d.jsx)("button",{className:t,onClick:e.onClick,onContextMenu:e.onContextMenu,children:s})}function x(e){var t=0===e.maxSteps?"":"Steps: ",s=Object(d.jsx)("input",{type:"range",min:"0",max:e.maxSteps,value:e.currentStep,onChange:e.onChange});return Object(d.jsxs)("div",{id:"stepcounter",children:[t,0===e.maxSteps?"":s]})}var O=function(e){Object(l.a)(s,e);var t=Object(c.a)(s);function s(){return Object(h.a)(this,s),t.apply(this,arguments)}return Object(u.a)(s,[{key:"renderSquare",value:function(e){var t=this;return Object(d.jsx)(k,{value:this.props.guesses[e],onClick:function(s){t.props.onClick(e),s.preventDefault()},onContextMenu:function(s){t.props.onContextMenu(e),s.preventDefault()}},e)}},{key:"render",value:function(){var e=this;return Object(d.jsx)("div",{children:Array.from(Array(this.props.height).keys()).map((function(t){return Object(d.jsx)("div",{className:"board-row",children:Array.from(Array(e.props.width).keys()).map((function(s){return e.renderSquare(s+t*e.props.width)}))},t)}))})}}]),s}(m.a.Component);O.defaultProps={height:b.Easy.height,width:b.Easy.width};var w=function(e){Object(l.a)(s,e);var t=Object(c.a)(s);function s(e){var i;return Object(h.a)(this,s),i=t.call(this,e),console.log("new game, level: "+JSON.stringify(e.level)),i.init(e.level),i.state=i.makeInitialState(),i}return Object(u.a)(s,[{key:"makeInitialState",value:function(){return{history:[{guesses:Array(this.numCells).fill(null)}],stepNumber:0,numFlags:0,gameState:p}}},{key:"init",value:function(e){this.level=e,this.width=e.width,this.height=e.height,this.numCells=this.width*this.height,this.numMines=e.mines,console.log("init: %d\xd7%d cells: %d mines: %d",this.width,this.height,this.numCells,this.numMines),console.assert(this.numCells>0)}},{key:"reset",value:function(e){this.init(void 0===e?this.level:e),this.setState(this.makeInitialState())}},{key:"handleClick",value:function(e,t){if(this.state.gameState===p){this.stateDirty=!1;var s=this.state.history.slice(0,this.state.stepNumber+1),i=s[s.length-1].guesses.slice(),n=this.state.gameState;0===this.state.stepNumber&&(this.mines=function(e,t,s,i){for(var n=t*s,a=Array(n).fill(0),r=1;r<=e;++r){for(var h=n-r,u=Math.floor(Math.random()*h);u===i||9===a[u];)u=h++;console.assert(9!==a[u]),a[u]=9;for(var l=0,c=Array.from(S(u,t,s));l<c.length;l++){var o=c[l];a[o]=9===a[o]?9:a[o]+1}}return a}(this.numMines,this.width,this.height,e));var a=this.state.numFlags;if(!0===t)"\ud83d\udea9"===i[e]?(i[e]=null,a--,this.stateDirty=!0):null===i[e]&&(i[e]="\ud83d\udea9",a++,this.stateDirty=!0),this.setState({numFlags:a});else if(null===i[e])n=this.revealAt(i,e);else{var h,u=this.mines[e],l=0,c=0,o=Object(r.a)(S(e,this.width,this.height));try{for(o.s();!(h=o.n()).done;){var m=h.value;"\ud83d\udea9"===i[m]?l++:null===i[m]&&c++}}catch(g){o.e(g)}finally{o.f()}if(c>0&&l>=u){var f,v=Object(r.a)(S(e,this.width,this.height));try{for(v.s();!(f=v.n()).done;){var d=f.value;if(null===i[d]&&(n=this.revealAt(i,d))===y)break}}catch(g){v.e(g)}finally{v.f()}}}n===y&&(this.setState({gameState:y}),this.onLoss(i,e)),this.checkWin(i)&&this.setState({gameState:j}),!0===this.stateDirty&&this.setState({history:s.concat([{guesses:i}]),stepNumber:s.length})}}},{key:"checkWin",value:function(e){for(var t=0;t<this.numCells;t++)if(9!==this.mines[t]&&(null===e[t]||"\ud83d\udea9"===e[t]))return!1;return!0}},{key:"onLoss",value:function(e,t){for(var s=0;s<this.numCells;++s)s!==t&&(9===this.mines[s]?null===e[s]&&(e[s]="\ud83d\udca3"):"\ud83d\udea9"===e[s]&&(e[s]="\ud83d\udea9\ud83d\udca3"))}},{key:"revealAt",value:function(e,t){if(null!==e[t])return p;if(9===this.mines[t])return e[t]="\ud83d\udca5",this.stateDirty=!0,y;if(0===this.mines[t]){e[t]="",this.stateDirty=!0;var s,i=Object(r.a)(S(t,this.width,this.height));try{for(i.s();!(s=i.n()).done;){var n=s.value;if(this.revealAt(e,n)===y)return y}}catch(a){i.e(a)}finally{i.f()}}else this.stateDirty=!0,e[t]=this.mines[t];return p}},{key:"render",value:function(){var e=this,t=this.state.history,s=t[this.state.stepNumber],i=Object(d.jsx)(x,{currentStep:this.state.stepNumber,maxSteps:t.length-1,onChange:function(t){return e.setState({stepNumber:t.target.value})}});return Object(d.jsxs)("div",{className:"game",children:[Object(d.jsxs)("div",{className:"game-status",children:[Object(d.jsx)("div",{className:"mine-counter status_button",children:this.numMines-this.state.numFlags}),Object(d.jsx)("div",{className:"emoji status_button",onClick:function(){return e.reset()},children:this.state.gameState})]}),Object(d.jsx)("div",{className:"game-board",children:Object(d.jsx)(O,{width:this.width,height:this.height,guesses:s.guesses,onClick:function(t){return e.handleClick(t,!1)},onContextMenu:function(t){e.handleClick(t,!0)}})}),Object(d.jsx)("div",{className:"game-info",children:i})]})}}]),s}(m.a.Component);function C(e,t){return[e%t,e/t>>0]}function S(e,t,s){var i,r,h,u,l,c,o,m,f;return n.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:i=C(e,t),r=Object(a.a)(i,2),h=r[0],u=r[1],l=0===u?0:u-1,c=h===t-1?h:h+1,o=u===s-1?u:u+1,m=0===h?0:h-1;case 6:if(!(m<=c)){n.next=18;break}f=l;case 8:if(!(f<=o)){n.next=15;break}if(h===m&&u===f){n.next=12;break}return n.next=12,m+f*t;case 12:++f,n.next=8;break;case 15:++m,n.next=6;break;case 18:case"end":return n.stop()}}),g)}w.defaultProps={level:b.Easy},v.a.render(Object(d.jsx)(w,{level:b.Easy}),document.getElementById("root"))},18:function(e,t,s){}},[[12,1,2]]]);
//# sourceMappingURL=main.303cb9e1.chunk.js.map